#!/bin/bash

PROJECT=$1

echo "Using PREFIX="${PREFIX:=`pwd`}
echo "Using PROJECT="${PROJECT:=$PREFIX/project}
echo "Using COCCI="${COCCI:=$PREFIX/cocci}
echo "Using RESULTS="${RESULTS:=$PREFIX/results}
echo "Using SPFLAGS="${SPFLAGS:="-quiet -timeout 60 -use_glimpse"}

echo -e "\nFor efficiency, run \`<coccinelle dir>/scripts/glimpseindex_cocci.sh\`"
echo -e "in $PROJECT\n"

sed -i "s|^PREFIX?=.*$|PREFIX?=${PREFIX}|" Makefile
sed -i "s|^PROJECT?=.*$|PROJECT?=${PROJECT}|" Makefile
sed -i "s|^COCCI?=.*$|COCCI?=${COCCI}|" Makefile
sed -i "s|^RESULTS?=.*$|RESULTS?=${RESULTS}|" Makefile
sed -i "s|^SPFLAGS?=.*$|SPFLAGS?=\"${SPFLAGS}\"|" Makefile

